# ZeroLogic

A simple chess engine for graphing calculators.

## Use

We use the uci-protocol for communication with the engine.

Commands supported at the moment:
```
uci info
```
```
position startpos
```
```
d
```
```
position fen {fen}
```
```
go perft {depth}
```
```
go depth {depth}
```
```
go single {depth}
```

## Compilation

The application is only tested with windows and ndless, to compile for the latter some adjustments have to be made to the code. 
Most importantly the macros *BitCount*, *SquareOf* and *Bitloop* defined in [gamestate.h](src/gamestate.h) and [eval.h](src/eval.h) have to be changed from intrinsics to their standart library equivallents.
(PEXT does not have an std equivallent, use [this function](https://stackoverflow.com/a/21159523) instead) 

You will get some other errors on compilation, those are relatively trivial, you wont have any problems resovling them. (Multi platform compatibility is a work in progress!!)

Remember to use the following flags in the Makefile generated by the ndless-sdk:
```
GCCFLAGS = -Wall -W -marm -std=c++23
LDFLAGS = -Wl,--nspireio
```

## Speed (Movegeneration)

We reach a speed of up to 1800 Meganodes per second per thread in Movegeneration (Tested on a Core i5-11400H), making the Open Source Abstract Movegenerating Algorithm (OSAMA) used in this program the fastest chess movegenerator in the world! In the time it takes to calculate one legal position, a photon would travel about 16cm.

```
Perft 8:
Overall nodes: 84,998,978,956
Time taken: 46.982s
Mn/s: 1809
s/Mn: 0.000552746
light distance equivalent: 0.165709 meters
tt hits: 129,787,406
```

This speed is due to heavy use of function inlining and templates (see [gamestate.h](src/gamestate.h)) and a transposition table.
The use of a transposition table triples movegeneration speed, but also results in the movegenerator *technically* not being perfect, due to the possibility of hash collisions. However this has never been observed. An option to do perft without a transposition table is going to be added soon.

The calculator version is capable of generating ~2 Meganodes per second. (Tested on a TI-nspire CX II-T) (latest version not tested)

Movegeneration is heavily inspired by Daniel Infuehr's [Gigantua](https://github.com/Gigantua/Gigantua/tree/2e82933789af6d83e7bfa2500b3de92e1698ddff).
